<!DOCTYPE html>
<html lang="hi">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Live TV Portal</title>
<script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
<style>
  :root{--accent:#ffcc00;}
  body{margin:0;background:#000;color:#fff;font-family:Poppins,system-ui,Arial;}
  h2{margin:12px 0;padding:8px 12px;color:var(--accent);text-align:center;text-shadow:0 0 8px var(--accent);}
  .container{padding:8px;}
  .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(120px,1fr));gap:12px}
  .channel{background:#111;border:2px solid var(--accent);border-radius:12px;padding:8px;cursor:pointer;text-align:center;transition:.18s;overflow:hidden}
  .channel:hover{transform:scale(1.04);box-shadow:0 0 18px rgba(255,204,0,.35)}
  .channel img{width:100%;height:92px;object-fit:cover;border-radius:8px}
  .channel span{display:block;margin-top:6px;color:var(--accent);font-size:13px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
  /* player overlay */
  #playerOverlay{display:none;position:fixed;inset:0;background:#000;z-index:9999;align-items:center;justify-content:center}
  #playerContainer{width:100%;height:100%;display:flex;align-items:center;justify-content:center}
  #playerVideo{width:100%;height:100%;background:#000;outline:none}
  @media(max-width:520px){.channel img{height:86px}}
</style>
</head>
<body>
<div class="container">
  <h2>üì∫ Odia Live TV</h2>
  <div class="grid" id="grid-odia">
    <div class="channel" data-src="https://www.youtube.com/embed/XbJGiL8d6nI?autoplay=1">
      <img src="https://i.ytimg.com/vi/XbJGiL8d6nI/hqdefault.jpg" alt="">
      <span>Jay Jagannath TV</span>
    </div>
    <div class="channel" data-src="https://livetv.tarangplus.in/otv-origin/live/otv-origin/live_720p/chunks.m3u8">
      <img src="https://i.supaimg.com/95d721c1-4ba3-4a25-9d7e-10c68916deae.png" alt="">
      <span>OTV Odia</span>
    </div>
    <div class="channel" data-src="https://livetv.tarangplus.in/prarthana-origin/live/prarthana-origin/live_720p/chunks.m3u8">
      <img src="https://i.supaimg.com/d667615d-a976-4906-9d0c-326fe4d9d741.jpg" alt="">
      <span>Prarthana TV</span>
    </div>
    <div class="channel" data-src="https://www.nandighoshatvlive.com/hls/stream/index.m3u8">
      <img src="https://i.supaimg.com/48140abd-ac93-43d1-b618-038bf2dc2623.png" alt="">
      <span>Nandighosha TV</span>
    </div>
    <div class="channel" data-src="https://d35j504z0x2vu2.cloudfront.net/v1/master/0bc8e8376bd8417a1b6761138aa41c26c7309312/prameya-news7/index.m3u8">
      <img src="https://i.supaimg.com/7eb6c294-3a46-42c6-917b-a225ffbe5e1d.jpg" alt="">
      <span>Prameya News7</span>
    </div>
    <div class="channel" data-src="https://livetv.tarangplus.in/tarangtv-origin/live/tarangtv-origin/live_720p/chunks.m3u8">
      <img src="https://i.supaimg.com/72e3f87e-d79e-4760-ba75-3a07cfc33b47.png" alt="">
      <span>Tarang TV</span>
    </div>
    <div class="channel" data-src="https://livetv.tarangplus.in/alankar-origin/live/playlist.m3u8">
      <img src="https://i.supaimg.com/3e7a3dce-2168-4174-bfd2-7e45df8a671c.webp" alt="">
      <span>Alankar TV</span>
    </div>
    <div class="channel" data-src="https://livetv.tarangplus.in/tarangmusic-origin/live/tarangmusic-origin/live_720p/chunks.m3u8">
      <img src="https://i.supaimg.com/94fc1595-abe4-48f6-a399-51f23bced0bd.jpg" alt="">
      <span>Tarang Music</span>
    </div>
  </div>

  <h2>üì∞ Hindi News Channels</h2>
  <div class="grid" id="grid-hindi">
    <div class="channel" data-src="https://nw18live.cdn.jio.com/bpk-tv/News18_India_NW18_MOB/output01/index.m3u8">
      <img src="https://i.supaimg.com/128ce764-490d-4aeb-9ccd-bedbe3252f42.jpg" alt="">
      <span>News18</span>
    </div>
    <div class="channel" data-src="https://feeds.intoday.in/aajtak/api/aajtakhd/master.m3u8">
      <img src="https://i.supaimg.com/f3c8120e-ba26-4e3c-9cf5-fb30f0fdc7fe.jpg" alt="">
      <span>Aaj Tak</span>
    </div>
    <div class="channel" data-src="https://r.jio.cdn.jio.com/jiohd/aj_pwa/stream.m3u8">
      <img src="https://i.supaimg.com/5f3e1f1a-3b5a-4d11-9c8b-9f2b6adf7b7e.png" alt="">
      <span>India TV (sample)</span>
    </div>
    <div class="channel" data-src="https://cdn.veesho.com/live/abp_digital/playlist.m3u8">
      <img src="https://i.supaimg.com/6f2f7a1c-2b7b-4d6f-a9e1-e5d2b8c5a5f1.jpg" alt="">
      <span>ABP News (sample)</span>
    </div>
    <div class="channel" data-src="https://live.urdu.geo.tv/hls/geo_news.m3u8">
      <img src="https://i.supaimg.com/sample13.png" alt="">
      <span>Sample Hindi News 1</span>
    </div>
    <div class="channel" data-src="https://example.com/news12.ts">
      <img src="https://i.supaimg.com/sample12.png" alt="">
      <span>Hindi News (example)</span>
    </div>
    <div class="channel" data-src="https://nw18live.cdn.jio.com/bpk-tv/News18_India_NW18_MOB/output01/index.m3u8">
      <img src="https://i.supaimg.com/eba3c858-6bd4-4b20-a62e-604805e25502.jpg" alt="">
      <span>News18 (alt)</span>
    </div>
    <div class="channel" data-src="https://streams.example.com/hindi/news_fake1.m3u8">
      <img src="https://i.supaimg.com/sample14.png" alt="">
      <span>Hindi News 7 (placeholder)</span>
    </div>
  </div>

  <h2>üèè Cricket Channels</h2>
  <div class="grid" id="grid-cricket">
    <div class="channel" data-src="http://spr1.packetcdn.me:2800/8be1228d2852985ebcbbb5382cc37a1c4668ac6e913f06523f0013/index.m3u8?token=1c7119da9c3c76009cc20146a29eb1532c2339e9f2fa91063444dced5a5d34933316bb81b2d488eb0cb78e1c3ede0ed27152e4e2d43e7862aff53abd2657aa44f52bd94b-3f8df6af673209e9689554395e269dff">
      <img src="https://i.supaimg.com/16c2e151-8aea-421e-9fcc-18c2116af6ff.webp" alt="">
      <span>Cricket 1</span>
    </div>
    <div class="channel" data-src="http://spr1.packetcdn.me:2800/8be1228d2852985ebcbbb5382cc27a025b65b8618d260b5e336417f605b7a1a26048d2ee2e7eb4eba6/index.m3u8?token=22c19f353bfad29763603d70f65fbddf24e7588b09d9306a5de7e7f3bb9739f5285cdc1deb5e744a0b1b702fe27a6e0f3057ba7f344f8f788f76473c6423c12003b496-f9518ead4f1c4f2e65363ba86b388811">
      <img src="https://i.supaimg.com/4cb872b5-ff11-44e5-9ac9-ca060bb1c272.jpg" alt="">
      <span>Cricket 7</span>
    </div>
    <div class="channel" data-src="http://spr1.packetcdn.me:2800/8be1228d2852985ebcbbb5382cd661054b64af718c39015e550469fb10b1/index.m3u8?token=6621346c50bc40e4f49b286f9ed01589697c54144613338a71970859f80e3864f80f682db770e64e9d03a6072b78a34824224b0777ec978c67269d9a9c9e6294a58d4d-1943ae25b4b844c2522d20981a5cf175">
      <img src="https://i.supaimg.com/fed6de58-f26c-439f-8a6d-77648716ff4d.png" alt="">
      <span>Cricket 9</span>
    </div>
    <div class="channel" data-src="http://spr1.packetcdn.me:2800/8be1228d2852985ebcbbb5382cc37e124663ac61ef550d472870/index.m3u8?filter=tracks:v1a1&token=fce9771ed3f2fdc0a217eec7e62cc711d42d620448c4b5f2c136b899688f960e8a296ab4a356ced2bceea56fc62fe2e922905d9905bb456fa8b99eeebe4b73dea8b4ca-2cb292690ebbc84e6fcc6c75779bc174">
      <img src="https://i.supaimg.com/8d5d313c-f089-4981-8ea4-10871ba029ca.png" alt="">
      <span>Cricket 11</span>
    </div>
    <div class="channel" data-src="https://techstop.online:443/live/God/God123/211.ts">
      <img src="https://i.supaimg.com/41c6d219-4e90-4da8-b799-1bbbc118b3f3.png" alt="">
      <span>Cricket (TS) 2</span>
    </div>
    <div class="channel" data-src="https://techstop.online:443/live/God/God123/148090.ts">
      <img src="https://i.supaimg.com/dd26733b-4be7-4818-9bd3-c0143e999ccb.png" alt="">
      <span>Cricket (TS) 3</span>
    </div>
    <div class="channel" data-src="https://techstop.online:443/live/God/God123/2494.ts">
      <img src="https://i.supaimg.com/f871e543-ffb9-4e14-9366-998b9bc7d3df.png" alt="">
      <span>Cricket (TS) 4</span>
    </div>
    <div class="channel" data-src="https://example.com/cricket_live_5.m3u8">
      <img src="https://i.supaimg.com/sample15.png" alt="">
      <span>Cricket (example)</span>
    </div>
  </div>

  <h2>üé¨ Movies</h2>
  <div class="grid" id="grid-movies">
    <div class="channel" data-src="https://techstop.online:443/movie/God/God123/472209.mkv">
      <img src="https://i.supaimg.com/9b9d8477-3fd2-410d-a775-bb90a9b29f53.jpg" alt="">
      <span>Bollywood Hits (mkv)</span>
    </div>
  </div>
</div>

<!-- Player overlay (no X button) -->
<div id="playerOverlay" role="dialog" aria-hidden="true">
  <div id="playerContainer">
    <video id="playerVideo" controls autoplay playsinline></video>
  </div>
</div>

<script>
/* --- Globals --- */
const overlay = document.getElementById('playerOverlay');
const playerVideo = document.getElementById('playerVideo');
let hls = null;
let refreshTimer = null;
const REFRESH_INTERVAL_MS = 8 * 60 * 1000; // 8 minutes

/* Normalize upstream URLs (handle relative proxy hints if present) */
function normalizeUpstream(u){
  if(!u) return u;
  if(/^https?:\/\//i.test(u)) return u;
  return u;
}

/* Wrap URL with Netlify function proxy */
function proxied(u){
  return '/.netlify/functions/proxy?u=' + encodeURIComponent(u);
}

/* Show / hide overlay */
function showOverlay(){ overlay.style.display='flex'; overlay.setAttribute('aria-hidden','false'); try{ screen.orientation.lock('landscape').catch(()=>{}); }catch(e){} }
function hideOverlay(){
  overlay.style.display='none';
  overlay.setAttribute('aria-hidden','true');
  if(hls){ try{ hls.destroy(); }catch(e){} hls=null; }
  try{ playerVideo.pause(); playerVideo.removeAttribute('src'); playerVideo.load(); }catch(e){}
  if(refreshTimer){ clearTimeout(refreshTimer); refreshTimer=null; }
  try{ if(document.fullscreenElement) document.exitFullscreen().catch(()=>{}); }catch(e){}
}

/* Close on ESC or overlay click */
document.addEventListener('keydown', (e)=>{ if(e.key==='Escape') hideOverlay(); });
overlay.addEventListener('click', (e)=>{ if(e.target===overlay) hideOverlay(); });

/* Play stream */
async function openStream(rawUrl, name){
  if(!rawUrl) return;
  const upstream = normalizeUpstream(rawUrl);
  const playUrl = proxied(upstream);

  // auto-refresh for tokened URLs
  if(upstream.includes('token=') || upstream.includes('/proxy/')){
    if(refreshTimer) clearTimeout(refreshTimer);
    refreshTimer = setTimeout(()=> {
      console.log('Auto-refreshing stream', name);
      openStream(rawUrl, name);
    }, REFRESH_INTERVAL_MS);
  }

  showOverlay();

  // YouTube special-case -> open in new tab (iframe autoplay often blocked)
  if(upstream.includes('youtube.com') || upstream.includes('youtu.be')){
    window.open(upstream, '_blank');
    hideOverlay();
    return;
  }

  // HLS handling
  if((upstream.endsWith('.m3u8') || upstream.includes('.m3u8')) && window.Hls && Hls.isSupported()){
    if(hls){ try{ hls.destroy(); }catch(e){} hls=null; }
    hls = new Hls();
    hls.on(Hls.Events.ERROR, function(event, data){
      console.error('HLS error', data);
      if(data && data.fatal){
        try{ hls.destroy(); }catch(e){}
        hls = null;
        playerVideo.src = playUrl; // try direct
        playerVideo.play().catch(()=>{});
      }
    });
    hls.loadSource(playUrl);
    hls.attachMedia(playerVideo);
    hls.on(Hls.Events.MANIFEST_PARSED, ()=>{ playerVideo.play().catch(()=>{}); });
  } else {
    // direct file fallback (.ts, .mkv etc.)
    try{
      playerVideo.src = playUrl;
      playerVideo.play().catch(()=>{ /* autoplay blocked */ });
    }catch(e){ console.error(e); }
  }

  // Try fullscreen (must be user gesture ‚Äî we are inside click handler)
  try{
    const c = document.getElementById('playerContainer');
    if(c.requestFullscreen) c.requestFullscreen().catch(()=>{});
    else if(c.webkitRequestFullscreen) c.webkitRequestFullscreen().catch(()=>{});
  }catch(e){}
}

/* Attach click handlers */
document.querySelectorAll('.channel').forEach(ch=>{
  ch.addEventListener('click', ()=>{
    const url = ch.getAttribute('data-src');
    const name = (ch.querySelector('span') || {}).textContent || 'Live';
    openStream(url, name);
  });
});
</script>
</body>
</html>
